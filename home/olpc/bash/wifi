#WIFI Version 2.0


WIFILE=~/.wifi
PROFLE_NAME=$(cat $WIFILE | grep $1 | awk -F, '{print $1}')
ESSID_VALUE=$(cat $WIFILE | grep $1 | awk -F, '{print $2}')
WEP_KEY_VAL=$(cat $WIFILE | grep $1 | awk -F, '{print $3}')
WPA_KEY_LOC=$(cat $WIFILE | grep $1 | awk -F, '{print $4}')
if [ $1 == $PROFLE_NAME ]
then
	echo "Profile match!"
	ESSID=$ESSID_VALUE
else
	echo "Trying $1 for the essid. Are you sure your spelling is correct"
	echo "If you connect to this access point often, add the information in ~/.wifi"
	ESSID=$1
fi
if [ -z $WEP_KEY_VAL ]
then
	echo "According to the profile, this AP has no WEP encryption."
else
	echo "Poor security is better than  no security."
	WEP="enc $WEP_KEY_VAL"
fi
if [ -z $WPA_KEY_LOC ]
then
	echo "According to the profile, this AP has no WPA encryption."
else
	sudo wpa_supplicant -ieth0 -c$WPA_KEY_LOC
fi
if [ $1 == mesh ]
then
	sudo iwconfig eth0 mode ad-hoc essid mesh
	sudo iwconfig msh0 channel 6
	sudo ifconfig msh0 $2
	sudo echo "mesh-up: this node IP address is $2"
else
	sudo iwconfig eth0 mode managed essid $ESSID $WEP
	sudo dhclient -r eth0
	sudo dhclient eth0
fi

#See LICENSE file for copyright and license details
